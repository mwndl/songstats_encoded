<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Song Stats</title>
    <link rel="stylesheet" href="style.css">
    <script src="axios.min.js"></script>
    <script src="script_lyrics.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vibrant.js/1.1.0/Vibrant.min.js"></script>
  </head>
  <body>
    <div class="containers">
      <div class="container_1">
        <div class="search-container">
          <input type="text" placeholder="Paste a Spotify track URL or ID" id="search_input">
          <button type="submit" id="search-btn">Search</button>
        </div>      
        <div class="top">
          <div class="music-cover" id="music_cover">
            <div>
              <button class="play-button" id="player_button" style="display:none" title="Song Preview"></button>
              <div class="#" style="display:none">
                <div class="music-player">
                  <audio controls class="audio-player" id="player">
                    <source src="#" id="song_preview" type="audio/mp3">
                  </audio>
                </div>
              </div>
            </div>
          </div>
          <div class="div-music-details">
            <div class="view_lyrics_button">
              <button class="view_lyrics_button" id="view_lyrics_button" style="display:none">
                <span id="view_lyrics_text">View Lyrics</span>
                <span id="view_lyrics_arrow" class="arrow-symbol">></span>
              </button>
            </div>
            <div class="music-details">
              <h2><a href="#" id="song_name" target="_blank"></a></h2>
              <p><p id="artist_name"></p></p>
              <p><a href="#" id="album_name" target="_blank"></a></p>
              <p id="release_date" style="font-size: 16px; margin-top: 5px;"></p>
            </div>
          </div>
        </div>      
        <div class="main-container">
          <div class="main">
            <div class="track-info">
              <div class="track-id">
                <p>Spotify ID:</p>
                <div class="input-group-ids">
                  <input type="text" placeholder="Not Available" class="track-input" id="track-input" value="" readonly>
                </div>
              </div>
              <div class="isrc">
                <p>ISRC:</p>
                <div class="input-group-ids">
                  <input type="text" placeholder="Not Available" class="isrc-input" id="isrc-input" value="" readonly>
                </div>
              </div>
            </div>
          </div>         
          <div class="main_1-right">
            <p id="duration"></p>
            <p id="album_position"></p>
            <p id="countries_counter"></p>
            <p id="popularity"></p>
            <p id="popularity_mxm"></p>
          </div>        
        </div>  
        <div class="main_2-div">
          <div class="all-stats">
            <div class="song-stats-div-1">
              <div class="song-stats">
                <div class="main_2-1-group">
                  <div class="main_2-1">
                    <div class="title-status-pair">
                      <p class="title">Lyrics</p>
                      <p class="status-1 status-gray" id="has_lyrics"></p>
                    </div>
                    <div class="title-status-pair">
                      <p class="title">Line-Sync</p>
                      <p class="status-1 status-gray" id="has_sync"></p>
                    </div>
                    <div class="title-status-pair">
                      <p class="title">Word-Sync</p>
                      <p class="status-1 status-gray" id="has_wordsync"></p>
                    </div>
                    <div class="title-status-pair">
                      <p class="title">Explicit</p>
                      <p class="status-1 status-gray" id="is_explicit"></p>
                    </div>
                    <div class="title-status-pair">
                      <p class="title">Instrumental</p>
                      <p class="status-1 status-gray" id="is_instrumental"></p>
                    </div>
                  </div>
                </div>
              </div>
            </div>  
            <div class="song-stats-div">
              <div class="song-stats">
                <div class="main_2-2-group">
                  <div class="main_2-1">
                    <div class="title-status-pair">
                      <p class="title">Lyrics on Spotify</p>
                      <p id="spotify_lyrics" class="status-2 status-gray"></p>
                    </div>
                    <div class="title-status-pair">
                      <p class="title">Sync on Spotify</p>
                      <p id="spotify_sync" class="status-2 status-gray"></p>
                    </div>
                  </div>
                </div>
              </div>
            </div>  
          </div>
          <div class="main_2-right">
            <div class="track-info">
              <div class="track-id">
                <p>Lyrics:</p>
                <div class="input-group-urls">
                  <input type="text" placeholder="Not Available" class="lyrics-url-track-input" id="mxm_lyrics_url" value="" readonly title="">
                </div>
              </div>
              <div class="isrc">
                <p>Artist:</p>
                <div class="input-group-urls">
                  <input type="text" placeholder="Not Available" class="artist-url-isrc-input" id="mxm_artist_url" value="" readonly title="">
                </div>
              </div>
              <div class="isrc">
                <p>Album:</p>
                <div class="input-group-urls">
                  <input type="text" placeholder="Not Available" class="album-url-input" id="mxm_album_url" value="" readonly title="">
                </div>
              </div>
              <div class="isrc">
                <p>Abstrack:</p>
                <div class="input-group-urls">
                  <input type="text" placeholder="Not Available" class="abstrack-input" id="mxm_abstrack" value="" readonly>
                </div>
              </div>
              <div class="last-update">
                <p id="last_update"></p>
              </div>
            </div>
          </div> 
        </div>
      </div>
      <div class="container_2" style="display:none" id="lyrics_container">
        <div id="div-lyrics-preview">
          <div class="iframe-mxm">
            <iframe class="lyrics_preview" id="lyrics_preview" src="" style="border:none;background:transparent;" width="100%" height="680px" style="font-size: 20px"></iframe>
          </div>
        </div>
      </div>
      <div class="container_3" style="display:none" id="pusher_container">
        <iframe class="lyrics_pusher" id="lyrics_pusher" src="" style="border:none;background:transparent;border-radius:20px;" width="100%" height="700px" style="font-size: 20px"></iframe>
        <button class="close_button" id="close_button_pusher"></button>
        <button class="refresh_button" id="refresh_button">
          <div class="refresh_symbol"></div>
        </button>
      </div>
    </div>
  </body>
  <script>
    var playButton = document.getElementById('player_button');
    var audioPlayer = document.getElementById('player');

    playButton.addEventListener('click', function() {
        if (audioPlayer.paused) {
            audioPlayer.play();
            playButton.classList.remove('play-button');
            playButton.classList.add('pause-button');
        } else {
            audioPlayer.pause();
            playButton.classList.remove('pause-button');
            playButton.classList.add('play-button');
        }
    });
    audioPlayer.addEventListener('ended', function() {
      playButton.classList.remove('pause-button');
      playButton.classList.add('play-button');
    });

    // Botão close_button_pusher 
    const closeButtonPusher = document.getElementById('close_button_pusher');
    const pusher_container = document.getElementById('pusher_container');
    
    const hideLyricsPusher = () => {
      pusher_container.style = "display:none";
    };
    closeButtonPusher.addEventListener('click', hideLyricsPusher);

    // Botão refresh pusher
    const lyricsPusher = document.getElementById('lyrics_pusher');
    const refreshButton = document.getElementById('refresh_button');

    const restartIframe = () => {
      lyricsPusher.src = lyricsPusher.src;
    };

    // Adiciona um ouvinte de evento de clique ao botão de refresh
    refreshButton.addEventListener('click', restartIframe);

</script>
</html>
