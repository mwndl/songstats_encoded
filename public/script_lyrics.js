window.addEventListener("load",(()=>{const t=document.querySelector("#background_animation_starter"),e=document.querySelector(".area"),s=document.querySelector("#search-btn"),a=document.querySelector("#search_input"),r=document.querySelector("#loading_spinner"),o=document.querySelector("#pusher_container"),l=document.querySelector("#lyrics_pusher"),n=document.querySelector("#close_button_pusher"),c=document.querySelector("#spotify_iframe_preview"),u=document.querySelector("#release_date"),i=document.querySelector("#album_position"),d=(document.querySelector("#song_preview"),document.querySelector("#countries_counter")),m=document.querySelector("#popularity"),y=document.querySelector("#spotify_lyrics_div"),_=document.querySelector("#spot_lyrics_title"),f=document.querySelector("#spot_sync_title"),p=document.querySelector("#track-input"),g=document.querySelector("#isrc-input"),v=document.querySelector("#mxm_links_content"),h=document.querySelector("#not_imported_message"),b=(document.querySelector("#loading_spinner_mxm"),document.querySelector("#mxm_lyrics_title")),k=document.querySelector("#mxm_artist_title"),x=document.querySelector("#mxm_album_title"),q=document.querySelector("#mxm_abstrack_title"),S=document.querySelector("#mxm_lyrics_url"),$=document.querySelector("#mxm_artist_url"),E=document.querySelector("#mxm_album_url"),w=document.querySelector("#mxm_abstrack"),I=document.querySelector("#popularity_mxm"),N=document.querySelector("#mxm_lyrics_url"),L=document.querySelector("#mxm_artist_url"),B=document.querySelector("#mxm_album_url"),C=document.querySelector("#mxm_stats_div"),D=document.querySelector("#has_lyrics_title"),A=document.querySelector("#has_sync_title"),T=document.querySelector("#has_wordsync_title"),M=document.querySelector("#is_explicit_title"),R=document.querySelector("#is_instrumental_title"),z=document.querySelector("#has_lyrics"),U=document.querySelector("#has_sync"),P=document.querySelector("#has_wordsync"),Z=document.querySelector("#is_explicit"),j=document.querySelector("#is_instrumental"),F=document.getElementById("notification"),H=document.getElementById("notification-message"),Y=document.getElementById("requests_conter"),G=document.getElementById("requests_counter_text"),J=document.getElementById("requests_counter_status");function K(t){H.textContent=t,F.style.opacity=1,F.classList.remove("hidden"),setTimeout((()=>{F.style.opacity=0,setTimeout((()=>{F.classList.add("hidden")}),500)}),4e3)}function Q(t){localStorage.setItem("background_mode",t)}let W=function(){const t=localStorage.getItem("background_mode");return t?parseInt(t,10):1}();let O=function(){const t=localStorage.getItem("token");return t||"8KuA9GwNbaJYvTD8U6h64beb6d6dd56c"}();const V=()=>{s.style="display:none",r.style="";const F=a.value.trim(),H=/(?:&|\?)player=spotify&(?:.*&)?track_id=([^&\s]+)/;let V;const X=/^\/set_token=([A-Za-z0-9_]+)$/,tt=F.match(/^\/set_country\/([A-Z]{2})$/);if(tt){return(t=>{t&&2===t.length?(localStorage.setItem("selected_country",t),K("Perfect! Your country is now local saved ðŸŒ"),a.value=""):(K("Invalid command, try again"),a.value="")})(tt[1]),r.style="display:none",void(s.style="")}if(/^(https?:\/\/open\.spotify\.com\/(?:intl-[a-z]{2}\/)?)?track\/(.+)$/.test(F)){const t=new URL(F);V="spotify_id=",search_value=t.pathname.split("/").pop()}else if(/https?:\/\/spotify\.link\/[\w-]+/.test(F)){fetch(`https://datamatch-backend.onrender.com/unshort?token=${O}url=${F}`).then((t=>t.json())).then((t=>{t.url?(F=t.url,r.style="",s.style="",a.value=""):(K("The URL provided could not be unshortened"),r.style="",s.style="",a.value="")})).catch((t=>{console.error("Error unshortening the URL:",t),K("An error occurred while unshortening this URL. Please use a 'open.spotify.com' link."),r.style="",s.style="",a.value=""}))}else if(H.test(F)){const t=F.match(H);t&&(V="spotify_id=",search_value=t[1])}else if(/^[a-zA-Z0-9]{22}$/.test(F))V="spotify_id=",search_value=F;else{if("/push"===F)return o.style="",l.src="https://musixmatch.typeform.com/to/tFQDvIsp?typeform-s",lyrics_container.style="display:none",a.value="",r.style="display:none",void(s.style="");if("/lyrics"===F)return r.style="display:none",s.style="",lyrics_container.style="",lyrics_preview.src=mxm_preview,o.style="display:none",void(a.value="");if("/studio"===F){r.style="display:none",s.style="";var et=mxm_edit_lyrics;return window.open(et,"_blank"),void(a.value="")}if(/^[A-Z]{2}[A-Z0-9]{3}\d{2}\d{5}$/.test(F))V="track_isrc=",search_value=F,a.value="";else{if(!X.test(F))return/^\/background=1$/.test(F)?(K("Background theme set successfully ðŸ–Œï¸"),W=1,Q(W),r.style="display:none",s.style="",void(a.value="")):/^\/background=2$/.test(F)?(K("Background theme set successfully ðŸ–Œï¸"),W=2,Q(W),r.style="display:none",s.style="",void(a.value="")):(K("Please enter a valid Spotify track URL or ID ðŸŽ¶"),r.style="display:none",s.style="",void(a.value=""));{const t=F.match(X);if(t){K("Personal token registered successfully ðŸ”‘");const e=t[1];return r.style="display:none",s.style="",a.value="",st=e,void localStorage.setItem("token",st)}}}}var st;a.value="";n.addEventListener("click",(()=>{o.style="display:none"})),fetch(`https://datamatch-backend.onrender.com/lyricsfinder-beta/search?${V}${search_value}&token=${O}&background_mode=${W}&spotify_lyrics=1&mxm_data=1`).then((t=>(t.ok||(500===t.status?(K("Sorry, we can't process your request at the moment ðŸ˜¥"),console.log("Internal Server Error (500)"),r.style="display:none",s.style="",J.className="requests_counter_status status-red",G.textContent="Server error",Y.style=""):503===t.status?(K("Starting the server, please wait a moment"),console.log("Dynamic Hibernate Error (503)"),r.style="display:none",s.style="",J.className="requests_counter_status status-yellow",G.textContent="Starting the server",Y.style=""):403===t.status?(K("The token you're using is invalid or has expired ðŸ”‘"),console.log("Access denied (403)"),r.style="display:none",s.style="",J.className="requests_counter_status status-red",G.textContent="Unauthorized",Y.style=""):404===t.status?(K("We couldn't find the track you are looking for ðŸ˜¥"),console.log("Resource not found (404)"),r.style="display:none",s.style="",J.className="requests_counter_status status-red",G.textContent="Not found",Y.style=""):429===t.status?(K("Too many requests, please try again later â›”"),console.log("Too many requests (429)"),r.style="display:none",s.style="",J.className="requests_counter_status status-red",G.textContent="Too many requests",Y.style=""):(K("Sorry, we can't process your request at the moment ðŸ˜¥"),console.log(`Unknown error: ${t.status}`),r.style="display:none",s.style="",J.className="requests_counter_status status-red",G.textContent="Unknown error",Y.style="")),t.json()))).then((a=>{let o,l;r.style="display:none",s.style="",headerData=a.message.header,o=a.message.body.spotify,l=a.message.body.musixmatch,spLyricsData=a.message.body.spotify_lyrics,customizationData=a.message.body.customization;const n=o.track_data.track_name,F=o.artists_data.artists[0].name,H=o.album_data.images[1].url,Q=o.track_data.track_id,W=o.track_data.isrc,O=o.album_data.release_date.toString();let V="";if(O.includes("-")){const t=O.split("-");V=`${t[2]}/${t[1]}/${t[0]}`,release_date_line=`Released on ${V}`}else V=O,release_date_line=`Released in ${V}`;const X=o.track_data.disc_position,tt=o.album_data.total_tracks,et=o.track_data.available_markets.length,st=o.track_data.popularity,at=spLyricsData.status_code,rt=spLyricsData.has_lyrics,ot=o.has_sync,lt=customizationData.background,nt=l.mxm_header.status_code;if(200===nt){const t=l.track_data.commontrack_id,e=l.track_data.lyrics_id,s=l.artist_data.artist_id,a=l.album_data.album_id,r=l.track_data.track_rating;mxm_preview=l.track_data.lyrics_preview_dark,mxm_edit_lyrics=l.track_data.studio_url;const o=l.track_data.track_name,n=l.artist_data.artist_name,c=l.album_data.album_name,u=l.track_data.stats.has_lyrics,i=l.track_data.stats.has_line_sync,d=l.track_data.stats.has_word_sync,m=l.track_data.stats.instrumental,y=l.track_data.stats.explicit;l.track_data.stats.restricted;S.setAttribute("value",`mxmt.ch/t/${e}`),$.setAttribute("value",`mxmt.ch/a/${s}`),E.setAttribute("value",`mxmt.ch/r/${a}`),w.setAttribute("value",`${t}`),N.title=o+" | Musixmatch",L.title=n+" | Musixmatch",B.title=c+" | Musixmatch",I.textContent=`Musixmatch Rating: ${r}%`,C.title="",D.style="",A.style="",T.style="",M.style="",R.style="",b.style="",k.style="",x.style="",q.style="",v.style="",h.style="display:none",z.className=0===u?"status-1 status-gray":1===u?"status-1 status-blue":"status-1 status-red",U.className=0===i?"status-1 status-gray":1===i?"status-1 status-blue":"status-1 status-red",P.className=0===d?"status-1 status-gray":1===d?"status-1 status-blue":"status-1 status-red",Z.className=0===y?"status-1 status-gray":1===y?"status-1 status-blue":"status-1 status-red",j.className=0===m?"status-1 status-gray":1===m?"status-1 status-blue":"status-1 status-red"}else 404===nt?(C.title="This track is not available on Musixmatch",D.style="color: #ffffff45",A.style="color: #ffffff45",T.style="color: #ffffff45",M.style="color: #ffffff45",R.style="color: #ffffff45",z.className="status-1 status-gray",U.className="status-1 status-gray",P.className="status-1 status-gray",Z.className="status-1 status-gray",j.className="status-1 status-gray",v.style="display:none",h.style=""):(K("An error occurred when fetching data from Musixmatch"),C.title="This track is not available on Musixmatch",D.style="color: #ffffff45",A.style="color: #ffffff45",T.style="color: #ffffff45",M.style="color: #ffffff45",R.style="color: #ffffff45",z.className="status-1 status-gray",U.className="status-1 status-gray",P.className="status-1 status-gray",Z.className="status-1 status-gray",j.className="status-1 status-gray",b.style="color: #ffffff45",k.style="color: #ffffff45",x.style="color: #ffffff45",q.style="color: #ffffff45");if(document.title=`${n} by ${F} | Songstats`,200===at?(!1===rt?spotify_lyrics.className="status-2 status-gray":!0===rt?spotify_lyrics.className="status-2 status-blue":(y.title="Feature disabled for this song due to restrictions",spotify_lyrics.className="status-2 status-gray",_.style="color: #ffffff45"),!1===ot?spotify_sync.className="status-2 status-gray":!0===ot?spotify_sync.className="status-2 status-blue":(y.title="Feature disabled for this song due to restrictions",spotify_sync.className="status-2 status-gray",f.style="color: #ffffff45")):(y.title="Feature disabled for this song due to restrictions",spotify_lyrics.className="status-2 status-gray",_.style="color: #ffffff45",spotify_sync.className="status-2 status-gray",f.style="color: #ffffff45"),"1"===lt){const t=document.getElementById("background_div"),e=document.createElement("div");e.className="blur-background",e.style.backgroundImage=`url('${H}')`,t.appendChild(e);let s=0;const a=30,r=3e3,o=()=>{s+=a/r,s<1&&(e.style.opacity=s,setTimeout(o,a))};o()}else if("2"===lt){document.getElementById("background_div").innerHTML='\n            <ul class="circles">\n              <li></li>\n              <li></li>\n              <li></li>\n              <li></li>\n              <li></li>\n              <li></li>\n              <li></li>\n              <li></li>\n              <li></li>\n              <li></li>\n            </ul>\n          ';const t=`rgb(${customizationData.album_colors.color_1.join(", ")})`,s=`rgb(${customizationData.album_colors.color_2.join(", ")})`;e.style.backgroundImage=`linear-gradient(45deg, ${t}, ${s})`}else{document.getElementById("background_div").innerHTML=`\n            <div class="blur-overlay"></div>\n            <div class="blur-background" style="background-image: url('${H}');"></div>\n          `}const ct=a.message.header.user.requests_counter,ut=a.message.header.user.requests_limit;c.src=`https://open.spotify.com/embed/track/${Q}?utm_source=generator&theme=0`,p.value=Q,g.value=W,u.textContent=release_date_line,i.textContent=`Album Position: ${X} of ${tt}`,d.textContent=`Available in ${et} markets`,m.textContent=`Spotify Rating: ${st}%`,J.className="requests_counter_status status-green",Y.style="",G.textContent=`${ct} of ${ut}`,t.innerHTML="\n        @keyframes animate {\n          0% {\n            transform: translateY(0) rotate(0deg);\n            opacity: 1;\n            border-radius: 0;\n          }\n          100% {\n            transform: translateY(-1000px) rotate(720deg);\n            opacity: 0;\n            border-radius: 50%;\n          }\n        }\n      "})).catch((t=>{console.error(t)}))};window.addEventListener("load",(()=>{const t=window.location.pathname.match(/^\/s\/(.+)$/);if(t){t[1];V()}})),s.addEventListener("click",V),a.addEventListener("keydown",(t=>{"Enter"===t.key&&(t.preventDefault(),V())})),document.getElementById("spotify_id_input").addEventListener("click",(function(){var t=document.getElementById("track-input");""!==t.value.trim()&&(t.select(),document.execCommand("copy"),K("Copied to your clipboard âœ¨"))})),document.getElementById("isrc_value_input").addEventListener("click",(function(){var t=document.getElementById("isrc-input");""!==t.value.trim()&&(t.select(),document.execCommand("copy"),K("Copied to your clipboard âœ¨"))})),document.getElementById("mxm_abstrack_input").addEventListener("click",(function(){var t=document.getElementById("mxm_abstrack");""!==t.value.trim()&&(t.select(),document.execCommand("copy"),K("Copied to your clipboard âœ¨"))})),document.getElementById("mxm_lyrics_input").addEventListener("click",(function(){var t=document.getElementById("mxm_lyrics_url"),e=t.value;if(""!==e.trim()){t.select();var s="http://"+e;window.open(s,"_blank")}})),document.getElementById("mxm_artist_input").addEventListener("click",(function(){var t=document.getElementById("mxm_artist_url"),e=t.value;if(""!==e.trim()){t.select();var s="http://"+e;window.open(s,"_blank")}})),document.getElementById("mxm_album_input").addEventListener("click",(function(){var t=document.getElementById("mxm_album_url"),e=t.value;if(""!==e.trim()){t.select();var s="http://"+e;window.open(s,"_blank")}}));let X=0,tt=!1;const et=document.getElementById("modo_dev");J.addEventListener("click",(()=>{tt?(K("Developer mode disabled ðŸ”§"),console.log("Developer mode has been disabled by the user"),tt=!1):(X++,5===X&&(K("Developer mode enabled ðŸ”§"),console.log("Developer mode has been enabled by the user"),X=0,tt=!0))})),et.addEventListener("click",(()=>{tt&&(console.log("Developer mode has been disabled by the user"),tt=!1)}))}));
