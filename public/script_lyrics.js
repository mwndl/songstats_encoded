window.addEventListener("load",(()=>{const t=document.querySelector("#background_animation_starter"),e=document.querySelector(".area"),s=document.querySelector("#search-btn"),r=document.querySelector("#search_input"),l=document.querySelector("#loading_spinner");a;const o=document.querySelector("#pusher_container"),n=document.querySelector("#lyrics_pusher"),c=document.querySelector("#close_button_pusher"),u=document.querySelector("#spotify_iframe_preview"),i=document.querySelector("#release_date"),d=document.querySelector("#album_position"),m=(document.querySelector("#song_preview"),document.querySelector("#countries_counter")),y=document.querySelector("#popularity"),_=document.querySelector("#spotify_lyrics_div"),f=document.querySelector("#spot_lyrics_title"),p=document.querySelector("#spot_sync_title"),g=document.querySelector("#track-input"),v=document.querySelector("#isrc-input"),h=document.querySelector("#mxm_links_content"),k=document.querySelector("#not_imported_message"),b=(document.querySelector("#loading_spinner_mxm"),document.querySelector("#mxm_lyrics_title")),x=document.querySelector("#mxm_artist_title"),q=document.querySelector("#mxm_album_title"),S=document.querySelector("#mxm_abstrack_title"),$=document.querySelector("#mxm_lyrics_url"),E=document.querySelector("#mxm_artist_url"),w=document.querySelector("#mxm_album_url"),N=document.querySelector("#mxm_abstrack"),I=document.querySelector("#popularity_mxm"),L=document.querySelector("#mxm_lyrics_url"),B=document.querySelector("#mxm_artist_url"),C=document.querySelector("#mxm_album_url"),A=document.querySelector("#mxm_stats_div"),D=document.querySelector("#has_lyrics_title"),T=document.querySelector("#has_sync_title"),M=document.querySelector("#has_wordsync_title"),z=document.querySelector("#is_explicit_title"),R=document.querySelector("#is_instrumental_title"),U=document.querySelector("#has_lyrics"),P=document.querySelector("#has_sync"),Z=document.querySelector("#has_wordsync"),j=document.querySelector("#is_explicit"),F=document.querySelector("#is_instrumental"),Y=document.getElementById("notification"),H=document.getElementById("notification-message"),G=document.getElementById("requests_conter"),J=document.getElementById("requests_counter_text"),K=document.getElementById("requests_counter_status");function Q(t){H.textContent=t,Y.style.opacity=1,Y.classList.remove("hidden"),setTimeout((()=>{Y.style.opacity=0,setTimeout((()=>{Y.classList.add("hidden")}),500)}),4e3)}function W(t){localStorage.setItem("background_mode",t)}let O=function(){const t=localStorage.getItem("background_mode");return t?parseInt(t,10):1}();let V=function(){const t=localStorage.getItem("token");return t||"8KuA9GwNbaJYvTD8U6h64beb6d6dd56c"}();const X=()=>{s.style="display:none",l.style="";const a=r.value.trim(),Y=/(?:&|\?)player=spotify&(?:.*&)?track_id=([^&\s]+)/;let H;const X=/^\/set_token=([A-Za-z0-9_]+)$/,tt=a.match(/^\/set_country\/([A-Z]{2})$/);if(tt){return(t=>{t&&2===t.length?(localStorage.setItem("selected_country",t),Q("Perfect! Your country is now local saved 🌍"),r.value=""):(Q("Invalid command, try again"),r.value="")})(tt[1]),l.style="display:none",void(s.style="")}if(/^(https?:\/\/open\.spotify\.com\/(?:intl-[a-z]{2}\/)?)?track\/(.+)$/.test(a)){const t=new URL(a);H="spotify_id=",search_value=t.pathname.split("/").pop()}else if(/https?:\/\/spotify\.link\/[\w-]+/.test(a)){fetch(`https://datamatch-backend.onrender.com/unshort?token=${V}url=${a}`).then((t=>t.json())).then((t=>{t.url?(a=t.url,l.style="",s.style="",r.value=""):(Q("The URL provided could not be unshortened"),l.style="",s.style="",r.value="")})).catch((t=>{Q("An error occurred while unshortening this URL. Please use a 'open.spotify.com' link."),l.style="",s.style="",r.value=""}))}else if(Y.test(a)){const t=a.match(Y);t&&(H="spotify_id=",search_value=t[1])}else if(/^[a-zA-Z0-9]{22}$/.test(a))H="spotify_id=",search_value=a;else{if("/push"===a)return o.style="",n.src="https://musixmatch.typeform.com/to/tFQDvIsp?typeform-s",lyrics_container.style="display:none",r.value="",l.style="display:none",void(s.style="");if("/lyrics"===a)return l.style="display:none",s.style="",lyrics_container.style="",lyrics_preview.src=mxm_preview,o.style="display:none",void(r.value="");if("/studio"===a){l.style="display:none",s.style="";var et=mxm_edit_lyrics;return window.open(et,"_blank"),void(r.value="")}if(/^[A-Z]{2}[A-Z0-9]{3}\d{2}\d{5}$/.test(a))H="track_isrc=",search_value=a,r.value="";else{if(!X.test(a))return/^\/background=1$/.test(a)?(Q("Background theme set successfully 🖌️"),O=1,W(O),l.style="display:none",s.style="",void(r.value="")):/^\/background=2$/.test(a)?(Q("Background theme set successfully 🖌️"),O=2,W(O),l.style="display:none",s.style="",void(r.value="")):(Q("Please enter a valid Spotify track URL or ID 🎶"),l.style="display:none",s.style="",void(r.value=""));{const t=a.match(X);if(t){Q("Personal token registered successfully 🔑");const e=t[1];return l.style="display:none",s.style="",r.value="",st=e,void localStorage.setItem("token",st)}}}}var st;r.value="";c.addEventListener("click",(()=>{o.style="display:none"})),fetch(`https://datamatch-backend.onrender.com/lyricsfinder-beta/search?${H}${search_value}&token=${V}&background_mode=${O}&spotify_lyrics=1&mxm_data=1`).then((t=>(t.ok||(500===t.status?(Q("Sorry, we can't process your request at the moment 😥"),l.style="display:none",s.style="",K.className="requests_counter_status status-red",J.textContent="Server error",G.style=""):503===t.status?(Q("Starting the server, please wait a moment"),l.style="display:none",s.style="",K.className="requests_counter_status status-yellow",J.textContent="Starting the server",G.style=""):403===t.status?(Q("The token you're using is invalid or has expired 🔑"),l.style="display:none",s.style="",K.className="requests_counter_status status-red",J.textContent="Unauthorized",G.style=""):404===t.status?(Q("We couldn't find the track you are looking for 😥"),l.style="display:none",s.style="",K.className="requests_counter_status status-red",J.textContent="Not found",G.style=""):429===t.status?(Q("Too many requests, please try again later ⛔"),l.style="display:none",s.style="",K.className="requests_counter_status status-red",J.textContent="Too many requests",G.style=""):(Q("Sorry, we can't process your request at the moment 😥"),l.style="display:none",s.style="",K.className="requests_counter_status status-red",J.textContent="Unknown error",G.style="")),t.json()))).then((a=>{let r,o;l.style="display:none",s.style="",headerData=a.message.header,r=a.message.body.spotify,o=a.message.body.musixmatch,spLyricsData=a.message.body.spotify_lyrics,customizationData=a.message.body.customization;const n=r.track_data.track_name,c=r.artists_data.artists[0].name,Y=r.album_data.images[1].url,H=r.track_data.track_id,W=r.track_data.isrc,O=r.album_data.release_date.toString();let V="";if(O.includes("-")){const t=O.split("-");V=`${t[2]}/${t[1]}/${t[0]}`,release_date_line=`Released on ${V}`}else V=O,release_date_line=`Released in ${V}`;const X=r.track_data.disc_position,tt=r.album_data.total_tracks,et=r.track_data.available_markets.length,st=r.track_data.popularity,at=spLyricsData.status_code,rt=spLyricsData.has_lyrics,lt=r.has_sync,ot=customizationData.background,nt=o.mxm_header.status_code;if(200===nt){const t=o.track_data.commontrack_id,e=o.track_data.lyrics_id,s=o.artist_data.artist_id,a=o.album_data.album_id,r=o.track_data.track_rating;mxm_preview=o.track_data.lyrics_preview_dark,mxm_edit_lyrics=o.track_data.studio_url;const l=o.track_data.track_name,n=o.artist_data.artist_name,c=o.album_data.album_name,u=o.track_data.stats.has_lyrics,i=o.track_data.stats.has_line_sync,d=o.track_data.stats.has_word_sync,m=o.track_data.stats.instrumental,y=o.track_data.stats.explicit;o.track_data.stats.restricted;$.setAttribute("value",`mxmt.ch/t/${e}`),E.setAttribute("value",`mxmt.ch/a/${s}`),w.setAttribute("value",`mxmt.ch/r/${a}`),N.setAttribute("value",`${t}`),L.title=l+" | Musixmatch",B.title=n+" | Musixmatch",C.title=c+" | Musixmatch",I.textContent=`Musixmatch Rating: ${r}%`,A.title="",D.style="",T.style="",M.style="",z.style="",R.style="",b.style="",x.style="",q.style="",S.style="",h.style="",k.style="display:none",U.className=0===u?"status-1 status-gray":1===u?"status-1 status-blue":"status-1 status-red",P.className=0===i?"status-1 status-gray":1===i?"status-1 status-blue":"status-1 status-red",Z.className=0===d?"status-1 status-gray":1===d?"status-1 status-blue":"status-1 status-red",j.className=0===y?"status-1 status-gray":1===y?"status-1 status-blue":"status-1 status-red",F.className=0===m?"status-1 status-gray":1===m?"status-1 status-blue":"status-1 status-red"}else 404===nt?(A.title="This track is not available on Musixmatch",D.style="color: #ffffff45",T.style="color: #ffffff45",M.style="color: #ffffff45",z.style="color: #ffffff45",R.style="color: #ffffff45",U.className="status-1 status-gray",P.className="status-1 status-gray",Z.className="status-1 status-gray",j.className="status-1 status-gray",F.className="status-1 status-gray",h.style="display:none",k.style=""):(Q("An error occurred when fetching data from Musixmatch"),A.title="This track is not available on Musixmatch",D.style="color: #ffffff45",T.style="color: #ffffff45",M.style="color: #ffffff45",z.style="color: #ffffff45",R.style="color: #ffffff45",U.className="status-1 status-gray",P.className="status-1 status-gray",Z.className="status-1 status-gray",j.className="status-1 status-gray",F.className="status-1 status-gray",b.style="color: #ffffff45",x.style="color: #ffffff45",q.style="color: #ffffff45",S.style="color: #ffffff45");if(document.title=`${n} by ${c} | Songstats`,200===at?(!1===rt?spotify_lyrics.className="status-2 status-gray":!0===rt?spotify_lyrics.className="status-2 status-blue":(_.title="Feature disabled for this song due to restrictions",spotify_lyrics.className="status-2 status-gray",f.style="color: #ffffff45"),!1===lt?spotify_sync.className="status-2 status-gray":!0===lt?spotify_sync.className="status-2 status-blue":(_.title="Feature disabled for this song due to restrictions",spotify_sync.className="status-2 status-gray",p.style="color: #ffffff45")):(_.title="Feature disabled for this song due to restrictions",spotify_lyrics.className="status-2 status-gray",f.style="color: #ffffff45",spotify_sync.className="status-2 status-gray",p.style="color: #ffffff45"),"1"===ot){const t=document.getElementById("background_div"),e=document.createElement("div");e.className="blur-background",e.style.backgroundImage=`url('${Y}')`,t.appendChild(e);let s=0;const a=30,r=3e3,l=()=>{s+=a/r,s<1&&(e.style.opacity=s,setTimeout(l,a))};l()}else if("2"===ot){document.getElementById("background_div").innerHTML='\n            <ul class="circles">\n              <li></li>\n              <li></li>\n              <li></li>\n              <li></li>\n              <li></li>\n              <li></li>\n              <li></li>\n              <li></li>\n              <li></li>\n              <li></li>\n            </ul>\n          ';const t=`rgb(${customizationData.album_colors.color_1.join(", ")})`,s=`rgb(${customizationData.album_colors.color_2.join(", ")})`;e.style.backgroundImage=`linear-gradient(45deg, ${t}, ${s})`}else{document.getElementById("background_div").innerHTML=`\n            <div class="blur-overlay"></div>\n            <div class="blur-background" style="background-image: url('${Y}');"></div>\n          `}const ct=a.message.header.user.requests_counter,ut=a.message.header.user.requests_limit;u.src=`https://open.spotify.com/embed/track/${H}?utm_source=generator&theme=0`,g.value=H,v.value=W,i.textContent=release_date_line,d.textContent=`Album Position: ${X} of ${tt}`,m.textContent=`Available in ${et} markets`,y.textContent=`Spotify Rating: ${st}%`,K.className="requests_counter_status status-green",G.style="",J.textContent=`${ct} of ${ut}`,t.innerHTML="\n        @keyframes animate {\n          0% {\n            transform: translateY(0) rotate(0deg);\n            opacity: 1;\n            border-radius: 0;\n          }\n          100% {\n            transform: translateY(-1000px) rotate(720deg);\n            opacity: 0;\n            border-radius: 50%;\n          }\n        }\n      "})).catch((t=>{}))};window.addEventListener("load",(()=>{const t=window.location.pathname.match(/^\/s\/(.+)$/);if(t){t[1];X()}})),s.addEventListener("click",X),r.addEventListener("keydown",(t=>{"Enter"===t.key&&(t.preventDefault(),X())})),document.getElementById("spotify_id_input").addEventListener("click",(function(){var t=document.getElementById("track-input");""!==t.value.trim()&&(t.select(),document.execCommand("copy"),Q("Copied to your clipboard ✨"))})),document.getElementById("isrc_value_input").addEventListener("click",(function(){var t=document.getElementById("isrc-input");""!==t.value.trim()&&(t.select(),document.execCommand("copy"),Q("Copied to your clipboard ✨"))})),document.getElementById("mxm_abstrack_input").addEventListener("click",(function(){var t=document.getElementById("mxm_abstrack");""!==t.value.trim()&&(t.select(),document.execCommand("copy"),Q("Copied to your clipboard ✨"))})),document.getElementById("mxm_lyrics_input").addEventListener("click",(function(){var t=document.getElementById("mxm_lyrics_url"),e=t.value;if(""!==e.trim()){t.select();var s="http://"+e;window.open(s,"_blank")}})),document.getElementById("mxm_artist_input").addEventListener("click",(function(){var t=document.getElementById("mxm_artist_url"),e=t.value;if(""!==e.trim()){t.select();var s="http://"+e;window.open(s,"_blank")}})),document.getElementById("mxm_album_input").addEventListener("click",(function(){var t=document.getElementById("mxm_album_url"),e=t.value;if(""!==e.trim()){t.select();var s="http://"+e;window.open(s,"_blank")}}));let tt=0,et=!1;const st=document.getElementById("modo_dev");K.addEventListener("click",(()=>{et?(Q("Developer mode disabled 🔧"),et=!1):(tt++,5===tt&&(Q("Developer mode enabled 🔧"),tt=0,et=!0))})),st.addEventListener("click",(()=>{et&&(et=!1)}))}));
